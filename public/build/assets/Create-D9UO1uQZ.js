import{c as e,B as t,r,w as l,v as o,E as a,G as s,u as n,H as d,x as i,D as u,J as c,P as p,I as m,N as x,K as g,O as v,L as y,U as f,F as b,V as h,C as w,y as k,m as _}from"./vendor-Da3FcZX6.js";import{_ as C}from"./NexusLayout-qEu_wr0Z.js";import{i as j,n as P,u as V,r as D,l as M}from"./ui-DwfAqvBQ.js";import"./app-CK322e5H.js";import"./DropdownLink-hHUY6dJe.js";const S={class:"max-w-2xl mx-auto bg-white p-8 rounded-3xl shadow-sm border border-gray-100 font-sans"},B={class:"flex items-center justify-between mb-8"},O=["min","max"],z={key:0,class:"text-red-600 text-[11px] mt-2 font-bold bg-red-50 p-2.5 rounded-lg border border-red-200 flex items-start gap-2 shadow-sm"},A={class:"leading-tight"},L={key:1,class:"text-red-500 text-xs mt-1 font-medium"},N=["value"],U={key:0,class:"text-red-500 text-xs mt-1 font-medium"},T={key:0},E={class:"w-full px-4 py-3 rounded-xl bg-gray-50 text-gray-900 border-0 font-semibold text-sm flex items-center justify-between group"},I={class:"relative"},q={key:0,class:"relative cursor-default select-none px-4 py-2 text-gray-700"},H={key:2,class:"text-red-500 text-xs mt-1"},F={key:0,class:"text-red-500 text-xs mt-1 font-medium"},G=["value"],J={key:0,class:"text-[10px] text-emerald-500 mt-1 italic"},K={key:1,class:"text-red-500 text-xs mt-1 font-medium"},Q={key:0,class:"text-red-500 text-xs mt-1 font-medium"},R={class:"flex items-center justify-end pt-4 border-t border-gray-50 mt-6"},W=["disabled"],X={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},Y={key:1,class:"w-4 h-4 text-white/90",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Z=Object.assign({layout:C},{__name:"Create",props:{customers:Array,products:Array,selectedCustomer:Object},setup(C){const Z=C,$=e(()=>!!Z.selectedCustomer),ee=t({planning_date:(new Date).toISOString().split("T")[0],activity_type:"",customer_id:Z.selectedCustomer?.id||"",project_name:"",product_id:Z.selectedCustomer?.product_id||"",description:""}),te=["Call","Visit","Ent","Online Meeting","Survey","Presentation","Proposal","Negotiation","Admin/Tender","Other"],re=r(""),le=r(Z.selectedCustomer||null),oe=e(()=>""===re.value?Z.customers:Z.customers.filter(e=>e.company_name.toLowerCase().includes(re.value.toLowerCase())));l(le,e=>{e?(ee.customer_id=e.id,e.product_id?ee.product_id=e.product_id:ee.product_id=""):(ee.customer_id="",ee.product_id="")}),e(()=>{if($.value&&Z.selectedCustomer?.product)return Z.selectedCustomer.product.name;if(le.value&&le.value.product)return le.value.product.name;if(ee.product_id){const e=Z.products.find(e=>e.id===ee.product_id);return e?e.name:""}return""});const ae=e(()=>(new Date).toISOString().split("T")[0]),se=e(()=>{const e=new Date;return e.setDate(e.getDate()+14),e.toISOString().split("T")[0]}),ne=()=>{ee.post(route("planning.store"))};return(e,t)=>(k(),o(b,null,[a(n(d),{title:"Create Plan"}),s("div",S,[s("div",B,[t[8]||(t[8]=i('<div class="flex items-center gap-3"><div class="bg-emerald-100 p-2 rounded-xl"><svg class="w-5 h-5 text-emerald-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.5v15m7.5-7.5h-15"></path></svg></div><h2 class="text-xl font-bold text-gray-900">Create New Plan</h2></div>',1)),a(n(p),{href:e.route("planning.index"),class:"group flex items-center gap-1.5 text-gray-500 hover:text-gray-900 transition-colors text-sm font-medium px-3 py-2 rounded-lg hover:bg-gray-50"},{default:u(()=>[...t[7]||(t[7]=[s("svg",{class:"w-4 h-4 group-hover:-translate-x-0.5 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),c(" Back ",-1)])]),_:1},8,["href"])]),s("form",{onSubmit:m(ne,["prevent"]),class:"space-y-6"},[s("div",null,[t[10]||(t[10]=s("label",{class:"block text-sm font-bold text-gray-700 mb-2"},"Planning Date",-1)),x(s("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>n(ee).planning_date=e),type:"date",required:"",min:ae.value,max:se.value,class:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-200 outline-none transition-all text-sm shadow-sm"},null,8,O),[[v,n(ee).planning_date]]),n(ee).planning_date&&(n(ee).planning_date<ae.value||n(ee).planning_date>se.value)?(k(),o("div",z,[t[9]||(t[9]=s("svg",{class:"w-4 h-4 text-red-500 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),s("span",A,"Date must be between "+y(ae.value)+" and "+y(se.value)+" (Max 2 weeks).",1)])):g("",!0),n(ee).errors.planning_date?(k(),o("div",L,y(n(ee).errors.planning_date),1)):g("",!0)]),s("div",null,[t[12]||(t[12]=s("label",{class:"block text-sm font-bold text-gray-700 mb-2"},"Activity Type",-1)),x(s("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>n(ee).activity_type=e),required:"",class:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-200 outline-none transition-all text-sm bg-white shadow-sm cursor-pointer"},[t[11]||(t[11]=s("option",{value:"",disabled:""},"Select Activity",-1)),(k(),o(b,null,h(te,e=>s("option",{key:e,value:e},y(e),9,N)),64))],512),[[f,n(ee).activity_type]]),n(ee).errors.activity_type?(k(),o("div",U,y(n(ee).errors.activity_type),1)):g("",!0)]),s("div",null,[t[16]||(t[16]=s("label",{class:"block text-sm font-bold text-gray-700 mb-2"},"Company Name",-1)),$.value?(k(),o("div",T,[s("div",E,[s("span",null,y(C.selectedCustomer?.company_name),1),t[13]||(t[13]=s("span",{class:"text-emerald-600 bg-emerald-100 px-2 py-0.5 rounded text-[10px] font-bold uppercase tracking-wide group-hover:bg-emerald-200 transition-colors"},"Locked",-1))])])):(k(),w(n(M),{key:1,modelValue:le.value,"onUpdate:modelValue":t[3]||(t[3]=e=>le.value=e),nullable:""},{default:u(()=>[s("div",I,[a(n(j),{class:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-200 outline-none transition-all text-sm bg-white shadow-sm",displayValue:e=>e?.company_name??"",onChange:t[2]||(t[2]=e=>re.value=e.target.value),placeholder:"Search company name..."},null,8,["displayValue"]),a(n(P),{class:"absolute inset-y-0 right-0 flex items-center pr-4"},{default:u(()=>[...t[14]||(t[14]=[s("svg",{class:"h-5 w-5 text-gray-400 group-hover:text-emerald-500 transition-colors",viewBox:"0 0 20 20",fill:"currentColor"},[s("path",{"fill-rule":"evenodd",d:"M10 3a.75.75 0 01.55.24l3.25 3.5a.75.75 0 11-1.1 1.02L10 4.852 7.3 7.76a.75.75 0 01-1.1-1.02l3.25-3.5A.75.75 0 0110 3zm-3.76 9.2a.75.75 0 011.06.04l2.7 2.908 2.7-2.908a.75.75 0 111.1 1.02l-3.25 3.5a.75.75 0 01-1.1 0l-3.25-3.5a.75.75 0 01.04-1.06z","clip-rule":"evenodd"})],-1)])]),_:1}),a(n(V),{class:"absolute z-50 mt-1 max-h-60 w-full overflow-auto rounded-xl bg-white py-1 text-sm shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"},{default:u(()=>[0===oe.value.length&&""!==re.value?(k(),o("div",q," No company found. ")):g("",!0),(k(!0),o(b,null,h(oe.value,e=>(k(),w(n(D),{key:e.id,value:e},{default:u(({selected:r,active:l})=>[s("li",{class:_(["relative cursor-pointer select-none py-2 pl-10 pr-4",{"bg-emerald-500 text-white":l,"text-gray-900":!l}])},[s("span",{class:_(["block truncate",{"font-medium":r,"font-normal":!r}])},y(e.company_name),3),r?(k(),o("span",{key:0,class:_(["absolute inset-y-0 left-0 flex items-center pl-3",{"text-white":l,"text-emerald-600":!l}])},[...t[15]||(t[15]=[s("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[s("path",{"fill-rule":"evenodd",d:"M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z","clip-rule":"evenodd"})],-1)])],2)):g("",!0)],2)]),_:2},1032,["value"]))),128))]),_:1})])]),_:1},8,["modelValue"])),n(ee).errors.customer_id?(k(),o("div",H,y(n(ee).errors.customer_id),1)):g("",!0)]),s("div",null,[t[17]||(t[17]=s("label",{class:"block text-sm font-bold text-gray-700 mb-2"},"Project",-1)),x(s("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>n(ee).project_name=e),type:"text",class:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-200 outline-none transition-all text-sm shadow-sm placeholder:text-gray-400",placeholder:"Enter project name (optional)"},null,512),[[v,n(ee).project_name]]),n(ee).errors.project_name?(k(),o("div",F,y(n(ee).errors.project_name),1)):g("",!0)]),s("div",null,[t[19]||(t[19]=s("label",{class:"block text-sm font-bold text-gray-700 mb-2"},"Product",-1)),x(s("select",{"onUpdate:modelValue":t[5]||(t[5]=e=>n(ee).product_id=e),class:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-200 outline-none transition-all text-sm bg-white shadow-sm cursor-pointer"},[t[18]||(t[18]=s("option",{value:""},"No Product",-1)),(k(!0),o(b,null,h(C.products,e=>(k(),o("option",{key:e.id,value:e.id},y(e.name),9,G))),128))],512),[[f,n(ee).product_id]]),n(ee).product_id?(k(),o("p",J,"* Product change here will also update the customer profile.")):g("",!0),n(ee).errors.product_id?(k(),o("div",K,y(n(ee).errors.product_id),1)):g("",!0)]),s("div",null,[t[20]||(t[20]=s("label",{class:"block text-sm font-bold text-gray-700 mb-2"},"Description Planning",-1)),x(s("textarea",{"onUpdate:modelValue":t[6]||(t[6]=e=>n(ee).description=e),required:"",rows:"4",class:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-200 outline-none transition-all text-sm resize-none shadow-sm placeholder:text-gray-400",placeholder:"Enter planning description"},null,512),[[v,n(ee).description]]),n(ee).errors.description?(k(),o("div",Q,y(n(ee).errors.description),1)):g("",!0)]),s("div",R,[s("button",{type:"submit",disabled:n(ee).processing,class:"px-8 py-3 bg-gradient-to-r from-emerald-500 to-emerald-600 hover:from-emerald-600 hover:to-emerald-700 text-white rounded-xl shadow-lg hover:shadow-xl font-bold transition-all transform hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none disabled:shadow-none flex items-center gap-2"},[n(ee).processing?(k(),o("svg",X,[...t[21]||(t[21]=[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):g("",!0),t[23]||(t[23]=s("span",null,"Create Plan",-1)),n(ee).processing?g("",!0):(k(),o("svg",Y,[...t[22]||(t[22]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2.5",d:"M12 4.5v15m7.5-7.5h-15"},null,-1)])]))],8,W)])],32)])],64))}});export{Z as default};
