import{B as e,c as t,v as r,E as s,G as o,u as l,H as a,J as n,L as i,D as d,P as c,I as u,K as p,N as m,O as x,U as g,F as b,V as f,m as v,y,x as h}from"./vendor-Da3FcZX6.js";import{_ as w}from"./NexusLayout-qEu_wr0Z.js";import{d as _,a as k,o as C}from"./ui-DwfAqvBQ.js";import"./app-CK322e5H.js";import"./DropdownLink-hHUY6dJe.js";const D={class:"max-w-2xl mx-auto bg-white p-8 rounded-3xl shadow-sm border border-gray-100 font-sans"},V={class:"flex items-center justify-between mb-8"},j={class:"flex items-center gap-3"},U={class:"text-xs text-gray-500 mt-0.5 flex items-center gap-1"},M={class:"font-bold text-gray-700"},P={class:"w-full px-4 py-3 rounded-xl bg-gray-50 border-0 text-gray-500 font-medium text-sm flex items-center gap-2 cursor-not-allowed"},S={key:0,class:"text-red-500 text-xs mt-1 font-medium"},T={key:0,class:"text-red-500 text-xs mt-1 font-medium"},B={key:0,class:"text-red-500 text-xs mt-1 font-medium"},q={key:0,class:"text-red-500 text-xs mt-1 font-medium"},O={key:0,class:"text-red-500 text-xs mt-1 font-medium"},z=["value"],N={key:0,class:"text-red-500 text-xs mt-1 font-medium"},A={class:"flex items-center justify-between bg-gray-50 p-4 rounded-xl border border-gray-100"},E={key:0,class:"absolute text-[10px] font-bold text-white left-2"},F={key:1,class:"absolute text-[10px] font-bold text-white right-2"},L={key:0,class:"text-red-500 text-xs mt-1 font-medium"},I={key:0,class:"bg-gradient-to-br from-emerald-50/80 to-teal-50/80 p-6 rounded-2xl border border-emerald-100 shadow-sm space-y-6"},R={class:"grid grid-cols-1 sm:grid-cols-2 gap-5"},Y=["required"],H=["value"],G={key:0,class:"text-red-500 text-xs mt-1 font-medium"},W=["required","min","max"],J={key:0,class:"text-red-600 text-[11px] mt-2 font-bold bg-red-50 p-2.5 rounded-lg border border-red-200 flex items-start gap-2 shadow-sm"},K={class:"leading-tight"},Q={key:1,class:"text-amber-700 text-[10px] mt-2 font-semibold bg-amber-50 p-2.5 rounded-lg border border-amber-200 flex items-start gap-2 shadow-sm"},X={key:2,class:"text-red-500 text-xs mt-1 font-medium"},Z={key:0,class:"text-red-500 text-xs mt-1 font-medium"},$={key:1,class:"bg-gradient-to-br from-gray-800 to-gray-900 p-4 sm:p-6 rounded-2xl border border-gray-700 shadow-lg"},ee={class:"flex items-center justify-end pt-4 border-t border-gray-50 mt-6"},te=["disabled"],re={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},se={key:1,class:"w-4 h-4 text-white/90",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},oe=Object.assign({layout:w},{__name:"CreateReport",props:{plan:Object,currentSimulatedTime:String},setup(w){const oe=w,le=e({execution_date:oe.currentSimulatedTime||(new Date).toISOString().split("T")[0],location:"",pic:"",position:"",result_description:"",next_plan_description:"",next_activity_type:"",next_planning_date:"",progress:"",is_success:!0}),ae=["Call","Visit","Ent","Online Meeting","Survey","Presentation","Proposal","Negotiation","Admin/Tender","Other"],ne=["10%-Introduction","20%-Visit","30%-Presentation","40%-Survey","50%-Proposal","75%-Confirm Budget","90%-Tender&Nego","100%-Closing"],ie=e=>{(e=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))).setUTCDate(e.getUTCDate()+4-(e.getUTCDay()||7));var t=new Date(Date.UTC(e.getUTCFullYear(),0,1));return Math.ceil(((e-t)/864e5+1)/7)},de=t(()=>{if(!le.next_planning_date)return!1;const e=new Date(le.execution_date),t=new Date(le.next_planning_date);return ie(e)===ie(t)&&e.getFullYear()===t.getFullYear()}),ce=t(()=>le.execution_date),ue=t(()=>{if(!le.execution_date)return"";const e=new Date(le.execution_date);return e.setDate(e.getDate()+14),e.toISOString().split("T")[0]}),pe=t(()=>"100%-Closing"===le.progress),me=()=>{le.post(route("planning.report.store",oe.plan.id))};return(e,t)=>(y(),r(b,null,[s(l(a),{title:"Create Report"}),o("div",D,[o("div",V,[o("div",j,[t[12]||(t[12]=o("div",{class:"bg-emerald-100 p-2 rounded-xl"},[o("svg",{class:"w-5 h-5 text-emerald-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1)),o("div",null,[t[11]||(t[11]=o("h2",{class:"text-xl font-bold text-gray-900"},"Create Report",-1)),o("p",U,[t[9]||(t[9]=n(" For: ",-1)),o("span",M,i(w.plan.customer.company_name),1),t[10]||(t[10]=o("span",{class:"text-gray-300"},"|",-1)),o("span",null,i(w.plan.project_name||"No Project"),1)])])]),s(l(c),{href:e.route("planning.index"),class:"group flex items-center gap-1.5 text-gray-500 hover:text-gray-900 transition-colors text-sm font-medium px-3 py-2 rounded-lg hover:bg-gray-50"},{default:d(()=>[...t[13]||(t[13]=[o("svg",{class:"w-4 h-4 group-hover:-translate-x-0.5 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),n(" Back ",-1)])]),_:1},8,["href"])]),o("form",{onSubmit:u(me,["prevent"]),class:"space-y-6"},[o("div",null,[t[15]||(t[15]=o("label",{class:"block text-sm font-bold text-gray-700 mb-2"},"Execution Date",-1)),o("div",P,[t[14]||(t[14]=o("svg",{class:"w-4 h-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),o("span",null,i(l(le).execution_date),1)]),l(le).errors.execution_date?(y(),r("div",S,i(l(le).errors.execution_date),1)):p("",!0)]),o("div",null,[t[16]||(t[16]=o("label",{class:"block text-sm font-bold text-gray-700 mb-2"},"Location",-1)),m(o("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>l(le).location=e),type:"text",required:"",class:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-200 outline-none transition-all text-sm shadow-sm placeholder:text-gray-400",placeholder:"Enter location"},null,512),[[x,l(le).location]]),l(le).errors.location?(y(),r("div",T,i(l(le).errors.location),1)):p("",!0)]),o("div",null,[t[17]||(t[17]=o("label",{class:"block text-sm font-bold text-gray-700 mb-2"},"Person In Charge",-1)),m(o("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>l(le).pic=e),type:"text",required:"",class:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-200 outline-none transition-all text-sm shadow-sm placeholder:text-gray-400",placeholder:"Enter person in charge"},null,512),[[x,l(le).pic]]),l(le).errors.pic?(y(),r("div",B,i(l(le).errors.pic),1)):p("",!0)]),o("div",null,[t[18]||(t[18]=o("label",{class:"block text-sm font-bold text-gray-700 mb-2"},"Division / Position",-1)),m(o("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>l(le).position=e),type:"text",required:"",class:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-200 outline-none transition-all text-sm shadow-sm placeholder:text-gray-400",placeholder:"Enter division or position"},null,512),[[x,l(le).position]]),l(le).errors.position?(y(),r("div",q,i(l(le).errors.position),1)):p("",!0)]),o("div",null,[t[19]||(t[19]=o("label",{class:"block text-sm font-bold text-gray-700 mb-2"},"Result Description",-1)),m(o("textarea",{"onUpdate:modelValue":t[3]||(t[3]=e=>l(le).result_description=e),required:"",rows:"3",class:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-200 outline-none transition-all text-sm resize-none shadow-sm placeholder:text-gray-400",placeholder:"Describe the result"},null,512),[[x,l(le).result_description]]),l(le).errors.result_description?(y(),r("div",O,i(l(le).errors.result_description),1)):p("",!0)]),o("div",null,[t[21]||(t[21]=o("label",{class:"block text-sm font-bold text-gray-700 mb-2"},"Progress",-1)),m(o("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>l(le).progress=e),required:"",class:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-200 outline-none transition-all text-sm bg-white shadow-sm cursor-pointer"},[t[20]||(t[20]=o("option",{value:"",disabled:""},"Select Progress",-1)),(y(),r(b,null,f(ne,e=>o("option",{key:e,value:e},i(e),9,z)),64))],512),[[g,l(le).progress]]),l(le).errors.progress?(y(),r("div",N,i(l(le).errors.progress),1)):p("",!0)]),o("div",null,[s(l(C),null,{default:d(()=>[o("div",A,[s(l(_),{class:"mr-4 text-sm font-bold text-gray-700"},{default:d(()=>[...t[22]||(t[22]=[n("Goal Achievement?",-1)])]),_:1}),s(l(k),{modelValue:l(le).is_success,"onUpdate:modelValue":t[5]||(t[5]=e=>l(le).is_success=e),class:v([l(le).is_success?"bg-emerald-500":"bg-red-500","relative inline-flex h-8 w-16 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2"])},{default:d(()=>[o("span",{class:v([l(le).is_success?"translate-x-9":"translate-x-1","inline-block h-6 w-6 transform rounded-full bg-white transition-transform"])},null,2),l(le).is_success?p("",!0):(y(),r("span",E,"FAIL")),l(le).is_success?(y(),r("span",F,"SUCC")):p("",!0)]),_:1},8,["modelValue","class"])])]),_:1}),l(le).errors.is_success?(y(),r("div",L,i(l(le).errors.is_success),1)):p("",!0)]),pe.value?p("",!0):(y(),r("div",I,[t[29]||(t[29]=h('<div class="flex items-center gap-2 mb-2"><div class="p-1.5 bg-emerald-100 rounded-lg"><svg class="w-4 h-4 text-emerald-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 5l7 7-7 7M5 5l7 7-7 7"></path></svg></div><h3 class="text-sm font-bold text-emerald-900 uppercase tracking-wider">Next Plan Details (Auto-Create)</h3></div>',1)),o("div",R,[o("div",null,[t[24]||(t[24]=o("label",{class:"block text-sm font-bold text-gray-700 mb-2"},"Activity Plan (Type)",-1)),m(o("select",{"onUpdate:modelValue":t[6]||(t[6]=e=>l(le).next_activity_type=e),required:!pe.value,class:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-200 outline-none transition-all text-sm bg-white shadow-sm cursor-pointer"},[t[23]||(t[23]=o("option",{value:"",disabled:""},"Select Activity",-1)),(y(),r(b,null,f(ae,e=>o("option",{key:e,value:e},i(e),9,H)),64))],8,Y),[[g,l(le).next_activity_type]]),l(le).errors.next_activity_type?(y(),r("div",G,i(l(le).errors.next_activity_type),1)):p("",!0)]),o("div",null,[t[27]||(t[27]=o("label",{class:"block text-sm font-bold text-gray-700 mb-2"},"Next Planning Date",-1)),m(o("input",{"onUpdate:modelValue":t[7]||(t[7]=e=>l(le).next_planning_date=e),type:"date",required:!pe.value,min:ce.value,max:ue.value,class:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-200 outline-none transition-all text-sm shadow-sm"},null,8,W),[[x,l(le).next_planning_date]]),l(le).next_planning_date&&(l(le).next_planning_date<ce.value||l(le).next_planning_date>ue.value)?(y(),r("div",J,[t[25]||(t[25]=o("svg",{class:"w-4 h-4 text-red-500 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),o("span",K,"Date must be between "+i(ce.value)+" and "+i(ue.value)+" (Max 2 weeks).",1)])):p("",!0),de.value?(y(),r("div",Q,[...t[26]||(t[26]=[o("span",{class:"text-base leading-none"},"âš ï¸",-1),o("span",{class:"leading-tight"},"Warning: This date is in the same week. Your completed plan will be overwritten by this new plan in the Weekly view.",-1)])])):p("",!0),l(le).errors.next_planning_date?(y(),r("div",X,i(l(le).errors.next_planning_date),1)):p("",!0)])]),o("div",null,[t[28]||(t[28]=o("label",{class:"block text-sm font-bold text-gray-700 mb-2"},"Plan Description (Optional)",-1)),m(o("textarea",{"onUpdate:modelValue":t[8]||(t[8]=e=>l(le).next_plan_description=e),rows:"3",class:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-200 outline-none transition-all text-sm resize-none shadow-sm placeholder:text-gray-400",placeholder:"Describe next plan (optional)"},null,512),[[x,l(le).next_plan_description]]),l(le).errors.next_plan_description?(y(),r("div",Z,i(l(le).errors.next_plan_description),1)):p("",!0)])])),pe.value?(y(),r("div",$,[...t[30]||(t[30]=[h('<div class="flex flex-col sm:flex-row items-center gap-3 sm:gap-4 text-center sm:text-left"><div class="p-2.5 sm:p-3 bg-emerald-500/20 rounded-xl flex-shrink-0"><svg class="w-6 h-6 sm:w-7 sm:h-7 text-emerald-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div><div><h3 class="text-sm sm:text-base font-bold text-white">ðŸŽ‰ Congratulations! Deal Closing</h3><p class="text-gray-400 text-xs sm:text-sm mt-1 leading-relaxed">No follow-up plan required. This customer will be marked as <span class="text-emerald-400 font-semibold">CLOSED</span> after approval.</p></div></div>',1)])])):p("",!0),o("div",ee,[o("button",{type:"submit",disabled:l(le).processing,class:"px-8 py-3 bg-gradient-to-r from-emerald-500 to-emerald-600 hover:from-emerald-600 hover:to-emerald-700 text-white rounded-xl shadow-lg hover:shadow-xl font-bold transition-all transform hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none disabled:shadow-none flex items-center gap-2"},[l(le).processing?(y(),r("svg",re,[...t[31]||(t[31]=[o("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),o("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):p("",!0),t[33]||(t[33]=o("span",null,"Submit Report",-1)),l(le).processing?p("",!0):(y(),r("svg",se,[...t[32]||(t[32]=[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2.5",d:"M5 13l4 4L19 7"},null,-1)])]))],8,te)])],32)])],64))}});export{oe as default};
