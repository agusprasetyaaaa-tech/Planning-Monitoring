import{B as e,r as t,v as r,E as s,G as l,u as o,H as a,L as n,D as i,J as d,P as c,N as u,R as p,I as g,O as b,a0 as x,F as f,V as m,K as h,y,m as k}from"./vendor-Da3FcZX6.js";import{_ as v}from"./NexusLayout-qEu_wr0Z.js";import"./app-CK322e5H.js";import"./DropdownLink-hHUY6dJe.js";const w={class:"space-y-6"},_={class:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4"},C={class:"flex flex-col md:flex-row items-center gap-3 w-full md:w-auto"},j={class:"text-sm text-gray-500 hidden md:inline-block whitespace-nowrap"},M={class:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100 flex items-center justify-between"},B={class:"relative inline-flex items-center cursor-pointer"},S={class:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100"},I={class:"space-y-4"},L={class:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100"},V={class:"space-y-4"},P={class:"flex gap-2"},z=["onKeydown"],A={class:"min-h-[100px] border border-dashed border-gray-200 rounded-lg p-3"},O={key:0,class:"text-center text-sm text-gray-400 py-4"},R={key:1,class:"flex flex-wrap gap-2"},H=["onClick"],K={class:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100 lg:col-span-2"},U={class:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-3"},D=["onClick"],E={key:0,class:"text-xs bg-red-200 text-red-800 px-1.5 rounded"},N={class:"lg:col-span-2 flex justify-end"},q=["disabled"],F={key:0,class:"animate-spin h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24"},G=Object.assign({layout:v},{__name:"Index",props:{settings:Object,current_ip:String,countries:Array},setup(v){const G=v,J=e({rate_limit:G.settings?.rate_limit??60,blocked_ips:G.settings?.blocked_ips||[],blocked_countries:G.settings?.blocked_countries||[],is_active:G.settings?.is_active??!0}),T=t(""),Q=()=>{T.value&&!J.blocked_ips.includes(T.value)&&(J.blocked_ips.push(T.value),T.value="")},W=()=>{J.patch(route("security.update"),{preserveScroll:!0,onSuccess:()=>{}})};return(e,t)=>(y(),r(f,null,[s(o(a),{title:"Security Settings"}),l("div",w,[l("div",_,[t[4]||(t[4]=l("h2",{class:"text-2xl font-bold text-gray-800"},"Security Settings",-1)),l("div",C,[l("span",j,"Current IP: "+n(v.current_ip),1),s(o(c),{href:e.route("security.online"),class:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg font-bold shadow hover:bg-blue-700 transition-all w-full md:w-auto"},{default:i(()=>[...t[3]||(t[3]=[l("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1),d(" Monitor Online Users ",-1)])]),_:1},8,["href"])])]),l("div",M,[t[6]||(t[6]=l("div",null,[l("h3",{class:"font-bold text-gray-800"},"Enable Security Features"),l("p",{class:"text-xs text-gray-500"},"Toggle all security checks (Rate Limit, Blocks)")],-1)),l("label",B,[u(l("input",{type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=e=>o(J).is_active=e),onChange:W,class:"sr-only peer"},null,544),[[p,o(J).is_active]]),t[5]||(t[5]=l("div",{class:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-emerald-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-emerald-600"},null,-1))])]),l("form",{onSubmit:g(W,["prevent"]),class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},[l("div",S,[t[9]||(t[9]=l("h3",{class:"font-bold text-emerald-600 mb-4 flex items-center gap-2"},[l("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})]),d(" Rate Limiting ")],-1)),l("div",I,[l("div",null,[t[7]||(t[7]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Max Requests per Minute",-1)),u(l("input",{type:"number","onUpdate:modelValue":t[1]||(t[1]=e=>o(J).rate_limit=e),class:"w-full rounded-lg border-gray-300 focus:ring-emerald-500 focus:border-emerald-500",min:"1"},null,512),[[b,o(J).rate_limit]]),t[8]||(t[8]=l("p",{class:"text-xs text-gray-500 mt-1"},"If an IP exceeds this limit, they will be blocked for 1 minute temporarily.",-1))])])]),l("div",L,[t[10]||(t[10]=l("h3",{class:"font-bold text-red-600 mb-4 flex items-center gap-2"},[l("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"})]),d(" IP Blocking ")],-1)),l("div",V,[l("div",P,[u(l("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>T.value=e),onKeydown:x(g(Q,["prevent"]),["enter"]),placeholder:"e.g. 192.168.1.1",class:"flex-1 rounded-lg border-gray-300 focus:ring-red-500 focus:border-red-500 placeholder:text-gray-400"},null,40,z),[[b,T.value]]),l("button",{type:"button",onClick:Q,class:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 font-medium"},"Add")]),l("div",A,[0===o(J).blocked_ips.length?(y(),r("div",O,"No IPs blocked")):(y(),r("div",R,[(y(!0),r(f,null,m(o(J).blocked_ips,e=>(y(),r("span",{key:e,class:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800"},[d(n(e)+" ",1),l("button",{type:"button",onClick:t=>(e=>{J.blocked_ips=J.blocked_ips.filter(t=>t!==e)})(e),class:"ml-1.5 text-red-600 hover:text-red-900 focus:outline-none"},"Ã—",8,H)]))),128))]))])])]),l("div",K,[t[11]||(t[11]=l("h3",{class:"font-bold text-orange-600 mb-4 flex items-center gap-2"},[l("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),d(" Country Blocking ")],-1)),t[12]||(t[12]=l("p",{class:"text-xs text-gray-500 mb-4"},"Click to toggle block status. Requires GeoIP or Cloudflare Headers.",-1)),l("div",U,[(y(!0),r(f,null,m(v.countries,e=>(y(),r("button",{key:e.code,type:"button",onClick:t=>{return r=e.code,void(J.blocked_countries.includes(r)?J.blocked_countries=J.blocked_countries.filter(e=>e!==r):J.blocked_countries.push(r));var r},class:k(["px-3 py-2 rounded-lg text-sm border font-medium transition-all flex justify-between items-center",o(J).blocked_countries.includes(e.code)?"bg-red-50 border-red-200 text-red-700 ring-1 ring-red-200":"bg-white border-gray-200 text-gray-600 hover:border-gray-300"])},[l("span",null,n(e.name),1),o(J).blocked_countries.includes(e.code)?(y(),r("span",E,"BLOCKED")):h("",!0)],10,D))),128))])]),l("div",N,[l("button",{type:"submit",disabled:o(J).processing,class:"px-6 py-2.5 bg-emerald-600 text-white rounded-xl font-bold shadow-lg shadow-emerald-200 hover:bg-emerald-700 transition-all flex items-center gap-2"},[o(J).processing?(y(),r("svg",F,[...t[13]||(t[13]=[l("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),l("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):h("",!0),t[14]||(t[14]=d(" Save Changes ",-1))],8,q)])],32)])],64))}});export{G as default};
